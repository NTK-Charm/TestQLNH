<!DOCTYPE html>
<html ng-app="FoodManagementApp">
<head>
    <title>Qu·∫£n l√Ω m√≥n ƒÉn</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="/js/food-management.js"></script>
</head>
<body ng-controller="FoodManagementCtrl">
    <div class="container">
        <h1>üçΩÔ∏è Qu·∫£n l√Ω m√≥n ƒÉn</h1>

        <!-- Form th√™m m√≥n ƒÉn -->
        <div class="add-food-form">
            <h3>‚ûï Th√™m m√≥n ƒÉn m·ªõi</h3>
            <div class="form-grid">
                <input type="text" ng-model="newFood.name" placeholder="T√™n m√≥n ƒÉn *" required>
                <input type="number" ng-model="newFood.price" placeholder="Gi√° *" min="0" required>
                <select ng-model="newFood.category" required>
                    <option value="">Ch·ªçn danh m·ª•c *</option>
                    <option ng-repeat="cat in categories" value="{{cat._id}}">{{cat.name}}</option>
                </select>
                <select ng-model="newFood.status">
                    <option ng-repeat="status in statusOptions" value="{{status.value}}">
                        {{status.label}}
                    </option>
                </select>
                <input type="text" ng-model="newFood.image" placeholder="URL h√¨nh ·∫£nh" class="full-width">
                <button ng-click="addFood()" class="btn-add">Th√™m m√≥n ƒÉn</button>
            </div>
        </div>

        <!-- Danh s√°ch m√≥n ƒÉn -->
        <div class="food-list">
            <h3>üìã Danh s√°ch m√≥n ƒÉn ({{foods.length}} m√≥n)</h3>
            <table>
                <thead>
                    <tr>
                        <th>STT</th>
                        <th>H√¨nh ·∫£nh</th>
                        <th>T√™n m√≥n</th>
                        <th>Gi√°</th>
                        <th>Danh m·ª•c</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="food in foods track by $index">
                        <td>{{$index + 1}}</td>
                        <td>
                            <img ng-src="{{food.image || '/images/default-food.jpg'}}"
                                 alt="{{food.name}}"
                                 class="food-image"
                                 onerror="this.src='/images/default-food.jpg'">
                        </td>
                        <td><strong>{{food.name}}</strong></td>
                        <td class="price">{{food.price | currency:'':0}} VNƒê</td>
                        <td>{{food.category?.name}}</td>
                        <td>
                            <span class="status-badge {{getStatusClass(food.status)}}">
                                {{getStatusLabel(food.status)}}
                            </span>
                        </td>
                        <td>
                            <button class="btn-edit" ng-click="editFood(food)">‚úèÔ∏è S·ª≠a</button>
                            <button class="btn-delete" ng-click="deleteFood(food._id)">üóëÔ∏è X√≥a</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Form ch·ªânh s·ª≠a (Modal) -->
        <div class="modal" ng-if="editingFood">
            <div class="modal-content">
                <h3>‚úèÔ∏è Ch·ªânh s·ª≠a m√≥n ƒÉn</h3>
                <div class="form-grid">
                    <input type="text" ng-model="editingFood.name" placeholder="T√™n m√≥n ƒÉn">
                    <input type="number" ng-model="editingFood.price" placeholder="Gi√°" min="0">
                    <select ng-model="editingFood.category">
                        <option ng-repeat="cat in categories" value="{{cat._id}}">
                            {{cat.name}}
                        </option>
                    </select>
                    <select ng-model="editingFood.status">
                        <option ng-repeat="status in statusOptions" value="{{status.value}}">
                            {{status.label}}
                        </option>
                    </select>
                    <input type="text" ng-model="editingFood.image" placeholder="URL h√¨nh ·∫£nh" class="full-width">
                </div>
                <div class="modal-actions">
                    <button class="btn-update" ng-click="updateFood()">üíæ C·∫≠p nh·∫≠t</button>
                    <button class="btn-cancel" ng-click="cancelEdit()">‚ùå H·ªßy</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>